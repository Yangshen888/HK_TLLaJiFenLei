(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e5f33c1"],{"1dda":function(t,e,a){"use strict";var r=a("38cd"),n=a.n(r);n.a},2955:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("dz-table",{attrs:{totalCount:t.stores.grab.query.totalCount,pageSize:t.stores.grab.query.pageSize},on:{"on-page-change":t.handlePageChanged,"on-page-size-change":t.handlePageSizeChanged}},[a("div",{attrs:{slot:"searcher"},slot:"searcher"},[a("section",{staticClass:"dnc-toolbar-wrap"},[a("Row",{attrs:{gutter:16}},[a("Col",{attrs:{span:"16"}},[a("Form",{attrs:{inline:""},nativeOn:{submit:function(t){t.preventDefault()}}},[a("FormItem",[a("Input",{staticStyle:{width:"150px"},attrs:{type:"text",search:"",clearable:!0,placeholder:"请输入车牌号码"},on:{"on-search":function(e){return t.handleSearchDispatch()}},model:{value:t.stores.grab.query.kw,callback:function(e){t.$set(t.stores.grab.query,"kw",e)},expression:"stores.grab.query.kw"}})],1)],1)],1),a("Col",{staticClass:"dnc-toolbar-btns",attrs:{span:"8"}},[a("ButtonGroup",{staticClass:"mr3"},[a("Button",{attrs:{icon:"md-refresh",title:"刷新"},on:{click:t.handleRefresh}})],1)],1)],1)],1)]),a("Table",{ref:"tables",attrs:{slot:"table",border:!1,size:"small","highlight-row":!0,data:t.stores.grab.data,columns:t.stores.grab.columns,"row-class-name":t.rowClsRender},on:{"on-select":t.handleSelect,"on-selection-change":t.handleSelectionChange,"on-refresh":t.handleRefresh,"on-page-change":t.handlePageChanged,"on-page-size-change":t.handlePageSizeChanged,"on-sort-change":t.handleSortChange},slot:"table",scopedSlots:t._u([{key:"auditState",fn:function(e){var r=e.row;e.index;return[a("span",[t._v(t._s(t.renderAuditState(r.auditState)))])]}},{key:"action",fn:function(e){var r=e.row;e.index;return[a("Tooltip",{attrs:{placement:"top",content:"历史轨迹",delay:1e3,transfer:!0}},[a("Button",{directives:[{name:"can",rawName:"v-can",value:"show1",expression:"'show1'"}],attrs:{type:"success",size:"small",shape:"circle",icon:"ios-cloud-upload"},on:{click:function(e){return t.handleDetail(r)}}},[t._v("历史轨迹")])],1)]}}])})],1)],1),a("Drawer",{attrs:{title:"历史轨迹",width:"1000","mask-closable":!1,mask:!1},model:{value:t.formModel.opened,callback:function(e){t.$set(t.formModel,"opened",e)},expression:"formModel.opened"}},[a("dz-table",{staticClass:"carlist"},[a("Table",{ref:"tables",attrs:{slot:"table",border:!1,size:"small","highlight-row":!0,data:t.formModel.carlist.data,columns:t.formModel.carlist.columns,"row-class-name":t.rowClsRender},slot:"table"})],1),a("Form",{ref:"formCarDispatchDetail",attrs:{model:t.formModel.fields,"label-position":"left"}},[t.btnClick?a("baidu-map",{staticClass:"map",staticStyle:{height:"700px"},attrs:{center:"桐庐",zoom:15,"scroll-wheel-zoom":!0},on:{ready:t.mapOnly}},[a("bm-scale",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),a("bm-navigation",{attrs:{anchor:"BMAP_ANCHOR_TOP_RIGHT"}}),a("bm-map-type",{attrs:{"map-types":["BMAP_NORMAL_MAP","BMAP_HYBRID_MAP"],anchor:"BMAP_ANCHOR_TOP_LEFT"}}),a("bml-lushu",{attrs:{path:t.points,icon:t.icon,play:t.play,speed:t.speed,rotation:!0},on:{stop:t.reset}})],1):t._e(),a("br"),a("Row",[[a("div",{staticStyle:{float:"left"}},[a("DatePicker",{staticStyle:{width:"200px"},attrs:{format:"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:t.formModel.carlist.query.kw1,callback:function(e){t.$set(t.formModel.carlist.query,"kw1",e)},expression:"formModel.carlist.query.kw1"}}),a("label",[t._v("调速：")])],1),a("div",[a("Slider",{staticStyle:{width:"200px",float:"left","margin-right":"10px"},attrs:{"v-model":t.speed,"tip-format":t.sliders,min:100,max:1e3}})],1),a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleDetail3()}}},[t._v("查询")]),a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.doplay(1)}}},[t._v("播放")]),a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.doplay(2)}}},[t._v("暂停")])]],2)],1)],1)],1)},n=[],s=(a("55dd"),a("dc44")),o=a("bd0c"),i=a("f93b"),l={name:"travel",components:{DzTable:s["a"],BmlLushu:o["BmlLushu"]},data:function(){return{lushu:{},path:[],icon:{url:"http://api.map.baidu.com/library/LuShu/1.2/examples/car.png",size:{width:52,height:26},opts:{anchor:{width:27,height:13}}},speed:100,play:!1,btnClick:!1,rowid:"",BMap:{},map:{},map2:{},BMap2:{},markers:[],points:[],formModel:{opened:!1,title:"历史轨迹",carlist:{query:{totalCount:0,pageSize:20,currentPage:1,isDelete:0,status:-1,kw:"",kw1:"",kw2:[],carUuid:"",sort:[{direct:"DESC",field:"ID"}]},sources:{},columns:[{title:"车牌号码",key:"carNum",sortable:!0},{title:"持有人",key:"holderId"},{title:"持有人电话",key:"holderPhone"},{title:"车辆重量/kg",key:"weight"}],data:[]}},stores2:{ljlist:{query:{totalCount:0,pageSize:5,currentPage:1,isDelete:0,status:-1,sort:[{direct:"DESC",field:"ID"}]},sources:{},columns:[{title:"小区名称",key:"vname",sortable:!0},{title:"垃圾箱名称",key:"ljname"},{title:"重量",key:"weight"},{title:"添加时间",key:"addTime"}],data:[]}},formModel2:{opened:!1,title:"实时查看",selection:[]},commands:{delete:{name:"delete",title:"删除"},recover:{name:"recover",title:"恢复"}},stores:{grab:{query:{totalCount:0,pageSize:20,currentPage:1,kw:"",isDelete:0,status:-1,sort:[{direct:"DESC",field:"ID"}]},sources:{},columns:[{type:"selection",width:50,key:"carUuid"},{title:"车牌号",key:"carNum",sortable:!0},{title:"所属公司",key:"company"},{title:"车辆类型",key:"carType",ellipsis:!0,tooltip:!0},{title:"垃圾类型",key:"grabType"},{title:"所属街道",key:"street"},{title:"操作",align:"center",width:300,className:"table-command-column",slot:"action"}],data:[]}}}},computed:{selectedRows:function(){return this.formModel.selection},selectedRowsId:function(){return this.formModel.selection.map(function(t){return t.carUuid})}},methods:{mapReady:function(t){this.BMap=t.BMap,this.map=t.map,this.loadLonLatList()},mapOnly:function(t){this.BMap2=t.BMap,this.map2=t.map},reset:function(){this.play=!1},sliders:function(t){return this.speed=t,"速度："+t},doplay:function(t){switch(t){case 1:this.play=!0;break;case 2:this.play=!1;break;case 3:break}},loadLonLatList:function(){var t=this;Object(i["d"])(this.stores.grab.query).then(function(e){for(var a=0;a<e.data.data.length;a++)if(null!=e.data.data[a].lat&&""!=e.data.data[a].lat&&null!=e.data.data[a].lon&&""!=e.data.data[a].lon){var r=new t.BMap.Marker(new t.BMap.Point(e.data.data[a].lon,e.data.data[a].lat));t.map.addOverlay(r)}})},handleDetail3:function(){var t=this;this.points=[],this.points.length>0&&this.map2.clearOverlays();var e=this.formModel.carlist.query;this.formModel.carlist.query.carUuid=this.rowid,""!=e.kw1?Object(i["i"])(this.formModel.carlist.query).then(function(e){for(var a=0;a<e.data.data.length;a++)if(null!=e.data.data[a].lat&&""!=e.data.data[a].lat&&null!=e.data.data[a].lon&&""!=e.data.data[a].lon){var r=new t.BMap2.Point(e.data.data[a].lon,e.data.data[a].lat);t.points.push(r)}var n=new t.BMap2.Polyline(t.points,{strokeColor:"blue",strokeWeight:5,strokeOpacity:.5});t.map2.addOverlay(n),t.map2.setViewport(t.points)}):this.$Message.warning("请选择时间段")},loadCarDispatchList:function(){var t=this;console.log(this.stores.grab.query),Object(i["g"])(this.stores.grab.query).then(function(e){t.stores.grab.data=e.data.data,t.stores.grab.query.totalCount=e.data.totalCount})},handlePageChanged:function(t){this.stores.grab.query.currentPage=t,this.loadCarDispatchList()},handlePageSizeChanged:function(t){this.stores.grab.query.pageSize=t,this.loadCarDispatchList()},loadCarDispatchList2:function(){var t=this;Object(i["f"])(this.stores2.ljlist.query).then(function(e){t.stores2.ljlist.data=e.data.data,t.stores2.ljlist.query.totalCount=e.data.totalCount})},handlePageChanged2:function(t){this.stores2.ljlist.query.currentPage=t,this.loadCarDispatchList2()},handlePageSizeChanged2:function(t){this.stores2.ljlist.query.pageSize=t,this.loadCarDispatchList2()},rowClsRender:function(t,e){return t.isDeleted?"table-row-disabled":""},handleSearchDispatch:function(){this.loadCarDispatchList()},handleRefresh:function(){this.loadCarDispatchList()},handleBatchCommand:function(t){var e=this;!this.selectedRowsId||this.selectedRowsId.length<=0?this.$Message.warning("请选择至少一条数据"):this.$Modal.confirm({title:"操作提示",content:"<p>确定要执行当前 ["+this.commands[t].title+"] 操作吗?</p>",loading:!0,onOk:function(){e.doBatchCommand(t)}})},doBatchCommand:function(t){var e=this;Object(i["e"])({command:t,ids:this.selectedRowsId.join(",")}).then(function(t){200===t.data.code?(e.$Message.success(t.data.message),e.loadCarDispatchList(),e.formModel.selection=[]):e.$Message.warning(t.data.message),e.$Modal.remove()})},handleSelect:function(t,e){},handleSelectionChange:function(t){this.formModel.selection=t},handleSortChange:function(t){this.stores.grab.query.sort.direction=t.order,this.stores.grab.query.sort.field=t.key,this.loadCarDispatchList()},handleSortChange2:function(t){this.stores2.ljlist.query.sort.direction=t.order,this.stores2.ljlist.query.sort.field=t.key,this.loadCarDispatchList2()},handleDetail:function(t){var e=this;this.btnClick=!0,this.points.length>0&&this.map2.clearOverlays();var a=new Date,r=a.getFullYear()+"-"+this.completeDate(a.getMonth()+1)+"-"+this.completeDate(a.getDate());this.formModel.carlist.query.kw1=r,this.points=[],this.rowid=t.carUuid,Object(i["h"])(t.carUuid).then(function(t){e.formModel.carlist.data=t.data.data,e.formModel.opened=!0,e.handleDetail3()}),this.loadCarDispatchList2()},handleDetail2:function(){this.formModel2.opened=!0},completeDate:function(t){return t<10?"0"+t:t}},mounted:function(){this.loadCarDispatchList()}},c=l,d=(a("1dda"),a("2877")),u=Object(d["a"])(c,r,n,!1,null,null,null);e["default"]=u.exports},"38cd":function(t,e,a){},bc57:function(t,e,a){"use strict";var r=a("ee02"),n=a.n(r);n.a},dc44:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dnc-table-wrap"},[t._t("searcher",[t.searchable&&"top"===t.searchPlace?a("div",{staticClass:"search-con search-con-top"},[a("Input",{staticClass:"search-input",attrs:{clearable:"",placeholder:"输入关键字搜索"},on:{"on-change":t.handleClear},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}}),a("Button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:t.handleSearch}},[a("Icon",{attrs:{type:"search"}}),t._v("  搜索\n      ")],1)],1):t._e()]),t._t("table",[t._v("暂无数据")]),a("div",{staticStyle:{"margin-top":"15px"}},[t._t("pager",[a("Page",{attrs:{total:t.totalCount,"page-size":t.pageSize,size:"small","show-elevator":"","show-sizer":"","show-total":"","page-size-opts":t.pageSizeOpts},on:{"on-change":t.onPageChanged,"on-page-size-change":t.onPageSizeChanged}})])],2)],2)},n=[],s=(a("c5f6"),{name:"DzTable",data:function(){return{searchValue:""}},props:{searchable:{type:Boolean,default:!1},searchPlace:{type:String,default:"top"},totalCount:{type:Number,default:0},pageSize:{type:Number,default:20},showRefreshButton:{type:Boolean,default:!1},pageSizeOpts:{type:Array,default:function(){return[5,10,20,30,40,50]}}},methods:{handleClear:function(){},handleSearch:function(){this.$emit("on-search")},onPageChanged:function(t){this.$emit("on-page-change",t)},onPageSizeChanged:function(t){this.$emit("on-page-size-change",t)}}}),o=s,i=(a("bc57"),a("2877")),l=Object(i["a"])(o,r,n,!1,null,null,null);e["a"]=l.exports},ee02:function(t,e,a){},f93b:function(t,e,a){"use strict";a.d(e,"g",function(){return n}),a.d(e,"d",function(){return s}),a.d(e,"i",function(){return o}),a.d(e,"h",function(){return i}),a.d(e,"b",function(){return l}),a.d(e,"c",function(){return c}),a.d(e,"f",function(){return d}),a.d(e,"e",function(){return u});var r=a("66df"),n=function(t){return r["a"].request({url:"grab/Travel/list",method:"post",data:t})},s=function(t){return r["a"].request({url:"grab/Travel/listlonlat",method:"post",data:t})},o=function(t){return r["a"].request({url:"grab/Travel/timeList",method:"post",data:t})},i=function(t){return r["a"].request({url:"grab/Travel/CarList?guid="+t,method:"get"})},l=function(){return r["a"].request({url:"grab/Travel/GetCarList",method:"get"})},c=function(){return r["a"].request({url:"grab/Travel/GetCarSite",method:"get"})},d=function(t){return r["a"].request({url:"grab/Travel/ljList",method:"post",data:t})},u=function(t){return r["a"].request({url:"grab/Travel/batch",method:"get",params:t})}}}]);