(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/volunteer/clockin"],{"0413":function(t,i,e){"use strict";e.r(i);var n=e("b39c"),s=e("c9bd");for(var a in s)"default"!==a&&function(t){e.d(i,t,(function(){return s[t]}))}(a);e("4f88");var o,d=e("f0c5"),l=Object(d["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],o);i["default"]=l.exports},"26e1":function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=e("1b54"),s=e("d51b"),a={data:function(){return{name:"我的名字",bzText:{time:"",address:"",img:"",remarks:""},type:"",r:80,Timer:[{time:"09:00"},{time:"18:00"}],isAm:!1,isPm:!1,amSign:{time:"",address:"",remarks:"",img:""},pmSign:{time:"",address:"",remarks:"",img:""},clickNum:0,is:null,isSign:!1,time:(0,n.formateDate)(new Date,"h:min:s"),date:(0,n.formateDate)(new Date,"Y-M-D"),latitude:"",longitude:"",address:"我的位置",wqInfo:null,allSign:[],signInfo:{mode:"",latitude:"",longitude:"",address:"",time:"",remarks:""},covers:[{id:0,callout:{content:"*****科技有限公司",color:"red",display:"ALWAYS"},latitude:37.788338,longitude:112.557031,iconPath:"../../../static/img/location.png"}],circles:[{latitude:30.23383,longitude:119.7248,radius:80,strokeWidth:1,fillColor:"#7fff0099"}]}},onLoad:function(){var t=(0,s.getSignInfo)();if(void 0!=t){var i=t.main.reverse();this.allSign=i,1==i.length?(0,n.isSameDay)(i[0].nowT)&&(this.isSign=!0,this.isAm=!0,this.allSign=i,this.amSign=i[0]):(i[0]&&(0,n.isSameDay)(i[0].nowT)&&(this.isSign=!0,this.isPm=!0,this.allSign=i,this.pmSign=i[0]),i[1]&&(0,n.isSameDay)(i[1].nowT)&&(this.isSign=!0,this.isAm=!0,this.allSign=i,this.amSign=i[1]))}this.getLocation(),this.getTime()},methods:{togglePopup:function(t){this.type=t},getAdd:function(){if(!this.isAm||!this.isPm){if(!0===this.is){var i=this.covers[0].callout.content;return this.address=i,void(this.signInfo.address=i)}var e=this,n="https://apis.map.qq.com/ws/geocoder/v1/?location=".concat(e.latitude,",").concat(e.longitude,"&key=").concat(s.key);console.log(n),t.request({url:n,success:function(i){console.log(i.data);var n=i.data;if(0==n.status){if(null===e.is&&(e.address="请检查位置信息！"),!1===e.is){var s=i.data.result.address+i.data.result.formatted_addresses.recommend;e.address=s,e.signInfo.address=s}}else t.showToast({title:n.message,icon:"none"})}})}},getData:function(){var i=this,e="";t.request({url:e,success:function(t){var e=t.data;i.covers[0].callout.content=e.name,i.covers[0].latitude=i.circles[0].latitude=e.latitude,i.covers[0].longitude=i.circles[0].longitude=e.longitude,i.r=i.circles.radius=e.r}})},bindDateChange:function(t){this.date=t.target.value},reset:function(){var i=this;t.showModal({title:"重置本地打卡信息",content:"您确定要重置打卡信息吗？点击确定本地打卡信息会被清除！",success:function(t){if(t.confirm)(0,s.delSignInfo)(),i.isSign=!1,i.isAm=!1,i.isPm=!1,i.allSign=[];else if(t.cancel)return}})},showBz:function(t){this.type="middle-list","amSign"==t?(this.bzText.time=this.amSign.time,this.bzText.address=this.amSign.address,this.bzText.remarks=this.amSign.remarks):"pmSign"==t&&(this.bzText.time=this.pmSign.time,this.bzText.address=this.pmSign.address,this.bzText.remarks=this.pmSign.remarks)},getTime:function(){var t=this;setInterval((function(){t.time=(0,n.formateDate)(new Date,"h:min:s")}),1e3)},getLocation:function(){var i=this;t.getLocation({type:"wgs84 ",success:function(e){t.hideLoading(),i.latitude=e.latitude,i.longitude=e.longitude,i.covers[1]={id:1,latitude:e.latitude,longitude:e.longitude,iconPath:"../../static/location.png"};var s=(0,n.pointInsideCircle)([i.latitude,i.longitude],[i.circles[0].latitude,i.circles[0].longitude],i.r/1e5);i.is=s,i.signInfo.latitude=e.latitude,i.signInfo.longitude=e.longitude,i.signInfo.mode=s?"正常打卡":"外勤打卡",i.getAdd()},fail:function(e){t.hideLoading(),i.address="请检查位置信息！",t.showToast({title:"请检查位置信息状态！",icon:"none",mask:!0,duration:3e3})}})},clickSign:function(){var i=this,e=this.is;if(null!==e){t.showLoading({title:"打卡记录中...",mask:!0}),this.signInfo.time=(0,n.formateDate)(new Date,"Y-M-D h:min:s");var a=(0,s.getSignInfo)();void 0!=a?(0,s.addSignInfo)((0,s.getInfo)(this.signInfo),a):(0,s.setSignInfo)((0,s.getInfo)(this.signInfo)),setTimeout((function(){t.hideLoading();var e=(0,s.getSignInfo)().main;i.allSign=e.reverse(),i.isSign=!0,!1===i.isAm?(i.isAm=!0,i.amSign=i.allSign[0]):(i.isPm=!0,i.pmSign=i.allSign[1]),t.showToast({title:"打卡成功！"})}),2e3)}else t.showToast({title:"请检查位置信息状态！",icon:"none",mask:!0,duration:3e3})},openLocation:function(){var i=this;t.chooseLocation({success:function(t){i.address=t.address,i.signInfo.address=t.address,i.signInfo.latitude=t.latitude,i.signInfo.longitude=t.longitude,i.latitude=t.latitude,i.longitude=t.longitude;var e=(0,n.pointInsideCircle)([i.latitude,i.longitude],[i.circles[0].latitude,i.circles[0].longitude],i.r/1e4);console.log(i.latitude+"---"+i.longitude),console.log(t),i.is=e}})}}};i.default=a}).call(this,e("543d")["default"])},"4f88":function(t,i,e){"use strict";var n=e("c452"),s=e.n(n);s.a},"8abf":function(t,i,e){"use strict";(function(t){e("f397"),e("921b");n(e("66fd"));var i=n(e("0413"));function n(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,e("543d")["createPage"])},b39c:function(t,i,e){"use strict";var n={"uni-icon":function(){return e.e("components/uni-icon/uni-icon").then(e.bind(null,"336b"))}},s=function(){var t=this,i=t.$createElement,e=(t._self._c,t.amSign.time.substring(10,16)),n=t.pmSign.time.substring(10,16);t.$mp.data=Object.assign({},{$root:{g0:e,g1:n}})},a=[];e.d(i,"b",(function(){return s})),e.d(i,"c",(function(){return a})),e.d(i,"a",(function(){return n}))},c452:function(t,i,e){},c9bd:function(t,i,e){"use strict";e.r(i);var n=e("26e1"),s=e.n(n);for(var a in n)"default"!==a&&function(t){e.d(i,t,(function(){return n[t]}))}(a);i["default"]=s.a}},[["8abf","common/runtime","common/vendor"]]]);